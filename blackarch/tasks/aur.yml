---
- name: AUR | Clone the YAY AUR package manager repository
  git:
    repo: https://aur.archlinux.org/yay.git
    dest: /dev/shm/yay
    clone: yes

- name: AUR | Edit sudoers file temporary
  lineinfile:
    dest: /etc/sudoers
    line: '{{ ansible_env.USER }} ALL=NOPASSWD: ALL'
    validate: 'visudo -cf %s'
  become: yes
  become_user: root

- name: AUR | Installing YAY Package
  command: makepkg -si --noconfirm 
  args:
    chdir: /dev/shm/yay

- name: AUR | Revert changes in sudoers file
  lineinfile:
    dest: /etc/sudoers
    state: absent
    regexp: '^{{ ansible_env.USER }} ALL=NOPASSWD: ALL'
  become: yes
  become_user: root

- name: AUR | Delete the YAY repository directory
  file:
    path: /dev/shm/yay
    state: absent
